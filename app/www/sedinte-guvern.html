<!DOCTYPE html>
<html>
<head>
	<title>Guvernul Romaniei - Ședinte Guvern</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css" />
	<link rel="stylesheet" href="css/global.css" />
	<link rel="stylesheet" href="css/sedinte-guvern.css" />
	<script src="js/jquery-1.11.1.min.js"></script>
	<script src="js/jquery.mobile-1.4.5.min.js"></script>
	<script>
    $(document).ready(function(){
    	var pageNo = 0
		getNext(pageNo)
		$(window).scroll(function() {
	   		if($(window).scrollTop() + $(window).height() == $(document).height()) {
	   			pageNo++;
	   			getNext(pageNo);
			}
		})
    })
	

	function getNext(pageNo){
		if (pageNo == 0) {
			var myurl = 'http://gov.ro/ro/json-sedinte-guvern';
		} else {
			var myurl = 'http://gov.ro/ro/json-sedinte-guvern&page=' + pageNo;
		}
		$.ajax({
		  dataType: "jsonp",
		  url: myurl,
		  jsonpCallback: 'callback',
		  type: 'GET',
		  }).done(function ( data ) {
		   $.each(data.rez, function(i, item){

		   	var date = item.data_publicarii.substring(0, item.data_publicarii.indexOf(' '))
		   	// vezi daca exista container pentru obiect in functie de data publicarii
		   	if ($('.'+date).length > 0) {
		   		// daca da, adauga la finalul containerului
		   		content = '<div data-role="collapsible"><h3>' + item.titlu +'</h3><p>'+ item.continut + '</p></div>'
				$('.'+date).append(content);
				$('.container-sedinte').collapsibleset('refresh')
		   	} else {
			   	// daca nu, creaza un nou container cu data publicarii ca si clasa
			   	content = '<div class="container-sedinte__item ' + date + '"><h2> Ședința din ' + date + '</h2><div data-role="collapsible"> <h3>' + item.titlu +'</h3><p>'+ item.continut +'</p> </div></div>'
			   	$('.container-sedinte').append(content);
				$('.container-sedinte').collapsibleset('refresh')

			}
			})
		  });
	}
	</script>
</head>
<body>

<div data-role="page">

	<div data-role="header" data-position="fixed">
		<h1>Guvernul Romaniei</h1>
		<a href="#meniu" class="ui-btn ui-icon-bars ui-btn-icon-notext ui-corner-all">No text</a>
	</div><!-- /header -->
	<div role="main" class="ui-content main-sedinte">
		<h1>Ședințe de Guvern</h1>
		<div class="container-sedinte" data-role="collapsible-set">
		</div>
	</div><!-- /content -->

	<div data-role="footer" data-position="fixed">
		
	</div><!-- /footer -->
	<div class='loader'>
		<img src="images/ajax-loader.gif" />
	</div>
	<div data-role="panel" id="meniu" data-theme="b" data-display="overlay">
		<a href="#" class="ui-btn">Agenda</a>
		<a href="#" class="ui-btn">Cabinet Ministri</a>
		<a href="#" class="ui-btn">Sedinte Guvern</a>
		<a href="#" class="ui-btn">Stiri</a>
		<a href="#" class="ui-btn">Termeni si conditii</a>
		<a href="#" class="ui-btn">Despre</a>
	</div><!-- /panel -->
	
	<div data-role="panel" id="search" data-theme="b" data-display="overlay" data-position="right">
		
</div>
</div><!-- /page -->

</body>
</html>
